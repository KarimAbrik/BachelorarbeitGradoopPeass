/**
 * Creates persistent graph, vertex and edge data. Writes data to HBase,
 * flushes the tables and reads/validates the data.
 */
@Test
public void writeFlushReadTest() {
    EPGMStore<VertexPojo, EdgePojo, GraphHeadPojo> graphStore = createEmptyEPGMStore();
    graphStore.setAutoFlush(false);
    // store some data
    for (PersistentGraphHead g : createPersistentGraphHead()) {
        graphStore.writeGraphHead(g);
    }
    for (PersistentVertex<EdgePojo> v : createPersistentVertex()) {
        graphStore.writeVertex(v);
    }
    for (PersistentEdge<VertexPojo> e : createPersistentEdge()) {
        graphStore.writeEdge(e);
    }
    // flush changes
    graphStore.flush();
    // validate
    validateGraphHead(graphStore);
    validateVertex(graphStore);
    validateEdge(graphStore);
    graphStore.close();
}