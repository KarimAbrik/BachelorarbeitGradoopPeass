/**
 * Creates the tables used by the graph store.
 *
 * @param config              Hadoop configuration
 * @param vertexHandler   vertex storage handler
 * @param edgeHandler     edge storage handler
 * @param graphHeadHandler    graph storage handler
 * @param vertexDataTableName vertex data table name
 * @param edgeTableName       edge data table name
 * @param graphDataTableName  graph data table name
 * @throws IOException
 */
private static void createTablesIfNotExists(final Configuration config, final VertexHandler vertexHandler, final EdgeHandler edgeHandler, final GraphHeadHandler graphHeadHandler, final String vertexDataTableName, final String edgeTableName, final String graphDataTableName) throws IOException {
    HTableDescriptor vertexDataTableDescriptor = new HTableDescriptor(TableName.valueOf(vertexDataTableName));
    HTableDescriptor edgeDataTableDescriptor = new HTableDescriptor(TableName.valueOf(edgeTableName));
    HTableDescriptor graphDataTableDescriptor = new HTableDescriptor(TableName.valueOf(graphDataTableName));
    HBaseAdmin admin = new HBaseAdmin(config);
    if (!admin.tableExists(vertexDataTableDescriptor.getName())) {
        vertexHandler.createTable(admin, vertexDataTableDescriptor);
    }
    if (!admin.tableExists(edgeDataTableDescriptor.getName())) {
        edgeHandler.createTable(admin, edgeDataTableDescriptor);
    }
    if (!admin.tableExists(graphDataTableDescriptor.getName())) {
        graphHeadHandler.createTable(admin, graphDataTableDescriptor);
    }
    admin.close();
}