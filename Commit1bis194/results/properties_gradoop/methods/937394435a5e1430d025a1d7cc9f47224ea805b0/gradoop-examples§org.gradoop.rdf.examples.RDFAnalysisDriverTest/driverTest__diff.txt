@Test
public void driverTest() throws Exception {
    Configuration conf = utility.getConfiguration();
    String graphFile = "countries.graph";
    String[] args = new String[] { "-" + ConfigurationUtils.OPTION_WORKERS, "1", "-" + ConfigurationUtils.OPTION_REDUCERS, "1", "-" + ConfigurationUtils.OPTION_HBASE_SCAN_CACHE, "500", "-" + ConfigurationUtils.OPTION_GRAPH_INPUT_PATH, graphFile, "-" + ConfigurationUtils.OPTION_GRAPH_OUTPUT_PATH, "/output/import/rdf", "-" + ConfigurationUtils.OPTION_DROP_TABLES };
    copyFromLocal(graphFile);
    RDFAnalysisDriver rdfAnalysisDriver = new RDFAnalysisDriver();
    rdfAnalysisDriver.setConf(conf);
    // run the pipeline
    int exitCode = rdfAnalysisDriver.run(args);
    // tests
    assertThat(exitCode, is(0));
    GraphStore graphStore = openGraphStore();
    // RDF results
    validateComponentForSampleVertex(graphStore);
    validateSelectAndAggregate(graphStore);
    graphStore.close();
}