@Test
public void testBulkLoadDriver() throws Exception {
    Configuration conf = utility.getConfiguration();
    String graphFile = "json-sample.graph";
    String[] args = new String[] { "-" + BulkLoadDriver.OPTION_GRAPH_INPUT_PATH, graphFile, "-" + BulkLoadDriver.OPTION_GRAPH_OUTPUT_PATH, "/output/import/extended-graph", "-" + BulkLoadDriver.OPTION_CUSTOM_ARGUMENT, "csv-reader.label=knows, csv-reader" + ".meta_data=person_knows_person.meta", "-" + BulkLoadDriver.LoadConfUtils.OPTION_VERTEX_LINE_READER, JsonReader.class.getCanonicalName(), "-" + BulkLoadDriver.LoadConfUtils.OPTION_DROP_TABLES };
    copyFromLocal(graphFile);
    BulkLoadDriver bulkLoadDriver = new BulkLoadDriver();
    bulkLoadDriver.setConf(conf);
    // run the bulk load
    int exitCode = bulkLoadDriver.run(args);
    // testing
    assertThat(exitCode, is(0));
    validateExtendedGraphVertices(openGraphStore());
}