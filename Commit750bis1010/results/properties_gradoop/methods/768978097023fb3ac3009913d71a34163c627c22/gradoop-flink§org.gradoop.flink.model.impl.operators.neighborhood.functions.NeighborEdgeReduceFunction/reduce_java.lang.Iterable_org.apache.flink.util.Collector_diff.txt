/**
 * {@inheritDoc}
 */
@Override
public void reduce(Iterable<Tuple2<Edge, Vertex>> tuples, Collector<Vertex> collector) throws Exception {
    PropertyValue propertyValue = PropertyValue.NULL_VALUE;
    Vertex vertex = null;
    Edge edge;
    boolean isFirst = true;
    for (Tuple2<Edge, Vertex> tuple : tuples) {
        edge = tuple.f0;
        if (isFirst) {
            //each tuple contains the same vertex
            vertex = tuple.f1;
            isFirst = false;
            propertyValue = getFunction().getEdgeIncrement(edge);
        } else {
            propertyValue = getFunction().aggregate(propertyValue, getFunction().getEdgeIncrement(edge));
        }
    }
    vertex.setProperty(getFunction().getAggregatePropertyKey(), propertyValue);
    collector.collect(vertex);
}