@Test
public void testGetDistinctColumnsIsomorphism() throws Exception {
    EmbeddingMetaData leftInputMetaData = new EmbeddingMetaData();
    leftInputMetaData.setEntryColumn("v1", EntryType.VERTEX, 0);
    leftInputMetaData.setEntryColumn("e1", EntryType.EDGE, 1);
    leftInputMetaData.setEntryColumn("v2", EntryType.VERTEX, 2);
    leftInputMetaData.setEntryColumn("e2", EntryType.EDGE, 3);
    leftInputMetaData.setEntryColumn("v3", EntryType.VERTEX, 4);
    EmbeddingMetaData rightInputMetaData = new EmbeddingMetaData();
    rightInputMetaData.setEntryColumn("v4", EntryType.VERTEX, 0);
    rightInputMetaData.setEntryColumn("e3", EntryType.EDGE, 1);
    rightInputMetaData.setEntryColumn("v5", EntryType.VERTEX, 2);
    rightInputMetaData.setEntryColumn("e4", EntryType.EDGE, 3);
    rightInputMetaData.setEntryColumn("v6", EntryType.VERTEX, 4);
    PlanNode leftChild = new MockPlanNode(null, leftInputMetaData);
    PlanNode rightChild = new MockPlanNode(null, rightInputMetaData);
    CartesianProductNode node = new CartesianProductNode(leftChild, rightChild, MatchStrategy.ISOMORPHISM, MatchStrategy.ISOMORPHISM);
    assertThat(call(CartesianProductNode.class, node, "getDistinctVertexColumnsLeft"), is(asList(0, 2, 4)));
    assertThat(call(CartesianProductNode.class, node, "getDistinctVertexColumnsRight"), is(asList(0, 2, 4)));
    assertThat(call(CartesianProductNode.class, node, "getDistinctEdgeColumnsLeft"), is(asList(1, 3)));
    assertThat(call(CartesianProductNode.class, node, "getDistinctEdgeColumnsRight"), is(asList(1, 3)));
}