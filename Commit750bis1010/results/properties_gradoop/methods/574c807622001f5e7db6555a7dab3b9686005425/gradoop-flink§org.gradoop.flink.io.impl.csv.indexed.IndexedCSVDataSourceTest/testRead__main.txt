/**
 * Test reading an indexed csv graph collection.
 *
 * @throws Exception on failure
 */
@Test
public void testRead() throws Exception {
    String csvPath = getFilePath("/data/csv/input_indexed_graph_collection");
    String gdlPath = getFilePath("/data/csv/expected/expected_graph_collection.gdl");
    DataSource dataSource = new IndexedCSVDataSource(csvPath, getConfig());
    GraphCollection input = dataSource.getGraphCollection();
    GraphCollection expected = getLoaderFromFile(gdlPath).getGraphCollectionByVariables("expected1", "expected2");
    collectAndAssertTrue(input.equalsByGraphData(expected));
}