/**
 * Test if the import and creation of a logical graph works correct. Set the first line
 * of the file as the column property names.
 *
 * @throws Exception on failure
 */
@Test
public void testImportLogicalGraphWithHeader() throws Exception {
    String csvPath = MinimalCSVImporterTest.class.getResource("/csv/input.csv").getPath();
    String gdlPath = MinimalCSVImporterTest.class.getResource("/csv/expected.gdl").getPath();
    FlinkAsciiGraphLoader loader = getLoaderFromFile(gdlPath);
    DataSource importVertexImporter = new MinimalCSVImporter(csvPath, DELIMITER, getConfig(), true);
    LogicalGraph resultGraph = importVertexImporter.getLogicalGraph();
    LogicalGraph expectedGraph = loader.getLogicalGraphByVariable("expected");
    collectAndAssertTrue(expectedGraph.equalsByElementData(resultGraph));
}