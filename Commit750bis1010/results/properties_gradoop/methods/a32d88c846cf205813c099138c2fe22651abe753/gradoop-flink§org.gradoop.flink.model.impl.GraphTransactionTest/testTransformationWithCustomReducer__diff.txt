@Test
public void testTransformationWithCustomReducer() throws Exception {
    FlinkAsciiGraphLoader loader = getSocialNetworkLoader();
    GraphCollection originalCollection = loader.getGraphCollection();
    DataSet<GraphTransaction> transactions = originalCollection.getGraphTransactions();
    GraphCollection restoredCollection = originalCollection.getFactory().fromTransactions(transactions, new First<>(), new First<>());
    collectAndAssertTrue(originalCollection.equalsByGraphIds(restoredCollection));
    collectAndAssertTrue(originalCollection.equalsByGraphElementIds(restoredCollection));
    collectAndAssertTrue(originalCollection.equalsByGraphData(restoredCollection));
}