@Override
public void initializeGlobal(int parallelism) throws IOException {
    this.parallelism = parallelism;
    // Prepare root output directory
    final FileSystem fs = rootOutputPath.getFileSystem();
    if (fs.isDistributedFS()) {
        if (!fs.initOutPathDistFS(rootOutputPath, writeMode, true)) {
            throw new IOException("Failed to initialize output root directory: " + rootOutputPath);
        }
    } else {
        if (writeMode == FileSystem.WriteMode.OVERWRITE) {
            try {
                fs.delete(rootOutputPath, true);
            } catch (IOException e) {
                throw new IOException("Could not remove existing output root directory: " + rootOutputPath, e);
            }
        }
        if (!fs.initOutPathLocalFS(rootOutputPath, writeMode, true)) {
            throw new IOException("Failed to initialize output root directory: " + rootOutputPath);
        }
    }
}