@Override
public GraphCollection getGraphCollection() throws IOException {
    DataSet<GraphTransaction> transactions;
    ExecutionEnvironment env = getConfig().getExecutionEnvironment();
    DataSet<Tuple2<LongWritable, Text>> input = null;
    input = env.createInput(HadoopInputs.readHadoopFile(new TLFInputFormat(), LongWritable.class, Text.class, getTLFPath()));
    // load tlf graphs from file
    assert input != null;
    transactions = input.map(new GraphTransactionFromText(getConfig()));
    // map the integer valued labels to strings from dictionary
    if (hasVertexDictionary()) {
        transactions = transactions.map(new VertexLabelDecoder()).withBroadcastSet(getVertexDictionary(), TLFConstants.VERTEX_DICTIONARY);
    }
    if (hasEdgeDictionary()) {
        transactions = transactions.map(new EdgeLabelDecoder()).withBroadcastSet(getEdgeDictionary(), TLFConstants.EDGE_DICTIONARY);
    }
    return getConfig().getGraphCollectionFactory().fromTransactions(transactions);
}