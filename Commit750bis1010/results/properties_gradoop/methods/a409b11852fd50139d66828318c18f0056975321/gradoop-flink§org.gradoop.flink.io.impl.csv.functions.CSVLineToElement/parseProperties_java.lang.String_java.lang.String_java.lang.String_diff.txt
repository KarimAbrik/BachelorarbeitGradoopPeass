/**
 * Parses the given property values according to the meta data associated with the specified
 * label.
 *
 * @param type                element type
 * @param label               element label
 * @param propertyValueString string representation of elements' property values
 * @return parsed properties
 */
protected Properties parseProperties(String type, String label, String propertyValueString) {
    String[] propertyValues = StringEscaper.split(propertyValueString, CSVConstants.VALUE_DELIMITER);
    List<PropertyMetaData> metaDataList = metaData.getPropertyMetaData(type, label);
    properties.clear();
    for (int i = 0; i < propertyValues.length; i++) {
        if (propertyValues[i].length() > 0) {
            properties.set(metaDataList.get(i).getKey(), metaDataList.get(i).getValueParser().apply(propertyValues[i]));
        }
    }
    return properties;
}