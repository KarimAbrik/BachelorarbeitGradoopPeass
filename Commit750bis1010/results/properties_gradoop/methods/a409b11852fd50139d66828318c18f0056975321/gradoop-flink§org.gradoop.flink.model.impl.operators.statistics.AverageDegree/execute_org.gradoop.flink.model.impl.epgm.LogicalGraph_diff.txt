@Override
public LogicalGraph execute(LogicalGraph graph) {
    graph = graph.aggregate(new VertexCount());
    DataSet<EPGMGraphHead> newGraphHead = new VertexDegrees().execute(graph).sum(1).crossWithTiny(graph.getGraphHead().first(1)).with(new AddSumDegreesToGraphHeadCrossFunction(SamplingEvaluationConstants.PROPERTY_KEY_SUM_DEGREES)).map(new CalculateAverageDegree(SamplingEvaluationConstants.PROPERTY_KEY_AVERAGE_DEGREE));
    return graph.getFactory().fromDataSets(newGraphHead, graph.getVertices(), graph.getEdges());
}