@Test
public void testIncomingVertexDegreeDistribution() throws Exception {
    LogicalGraph db = getSocialNetworkLoader().getLogicalGraph();
    List<WithCount<Long>> result = new IncomingVertexDegreeDistribution().execute(db).collect();
    assertThat(result.size(), is(4));
    Map<Long, Long> cache = new HashMap<>(4);
    result.forEach(e -> cache.put(e.getObject(), e.getCount()));
    assertThat(cache.get(0L), is(4L));
    assertThat(cache.get(2L), is(1L));
    assertThat(cache.get(3L), is(2L));
    assertThat(cache.get(4L), is(4L));
}