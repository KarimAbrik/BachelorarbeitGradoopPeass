@Test
public void testSplitWithSingleResultGraph() throws Exception {
    FlinkAsciiGraphLoader loader = getLoaderFromString("" + "g1:Persons [" + "(v0:Person {id : 0, author : \"value0\"})" + "(v1:Person {id : 0, author : \"value1\"})" + "(v2:Person {id : 0, author : \"value2\"})" + "(v3:Person {id : 0, author : \"value3\"})" + "(v0)-[e0:sameAs {id : 0, sim : \"0.91\"}]->(v1)" + "(v0)-[e1:sameAs {id : 1, sim : \"0.3\"}]->(v2)" + "(v2)-[e2:sameAs {id : 2, sim : \"0.1\"}]->(v1)" + "(v2)-[e3:sameAs {id : 3, sim : \"0.99\"}]->(v3)" + "]" + "g2 [" + "(v0)-[e0:sameAs {id : 0, sim : \"0.91\"}]->(v1)" + "(v0)-[e1:sameAs {id : 1, sim : \"0.3\"}]->(v2)" + "(v2)-[e2:sameAs {id : 2, sim : \"0.1\"}]->(v1)" + "(v2)-[e3:sameAs {id : 3, sim : \"0.99\"}]->(v3)" + "]");
    LogicalGraph input = loader.getLogicalGraphByVariable("g1");
    GraphCollection result = input.splitBy("id");
    collectAndAssertTrue(result.equalsByGraphElementIds(loader.getGraphCollectionByVariables("g2")));
    collectAndAssertTrue(result.equalsByGraphElementData(loader.getGraphCollectionByVariables("g2")));
}