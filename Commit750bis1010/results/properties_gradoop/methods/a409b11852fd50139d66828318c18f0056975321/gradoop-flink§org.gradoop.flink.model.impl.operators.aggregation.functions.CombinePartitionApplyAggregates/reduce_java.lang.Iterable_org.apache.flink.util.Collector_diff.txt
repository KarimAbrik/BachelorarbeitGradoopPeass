@Override
public void reduce(Iterable<Tuple2<GradoopId, Map<String, PropertyValue>>> values, Collector<Tuple2<GradoopId, Map<String, PropertyValue>>> out) throws Exception {
    Iterator<Tuple2<GradoopId, Map<String, PropertyValue>>> iterator = values.iterator();
    Tuple2<GradoopId, Map<String, PropertyValue>> aggregate = iterator.next();
    while (iterator.hasNext()) {
        Tuple2<GradoopId, Map<String, PropertyValue>> next = iterator.next();
        for (AggregateFunction aggFunc : aggregateFunctions) {
            String propertyKey = aggFunc.getAggregatePropertyKey();
            PropertyValue nextAgg = next.f1.get(propertyKey);
            if (nextAgg != null) {
                aggregate.f1.compute(propertyKey, (key, agg) -> agg == null ? nextAgg : aggFunc.aggregate(agg, nextAgg));
            }
        }
    }
    out.collect(aggregate);
}