/**
 * Function to test graph element datasets for dangling graph ids.
 *
 * @param idSet ids of the corresponding graph or graph collection.
 * @param elements element dataset to test for dangling grahp ids.
 * @param <E> element type.
 * @throws Exception when the execution in Flink fails.
 */
private <E extends GraphElement> void assertGraphContainment(GradoopIdSet idSet, DataSet<E> elements) throws Exception {
    for (E element : elements.collect()) {
        GradoopIdSet ids = element.getGraphIds();
        assertFalse("Element has no graph ids", ids.isEmpty());
        ids.removeAll(idSet);
        assertTrue("Element has dangling graph ids", ids.isEmpty());
    }
}