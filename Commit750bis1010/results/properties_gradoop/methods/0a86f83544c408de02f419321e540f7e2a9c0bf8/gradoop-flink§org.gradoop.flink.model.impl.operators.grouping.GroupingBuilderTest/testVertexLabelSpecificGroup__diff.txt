/**
 * Tests successful call to {@link Grouping.GroupingBuilder#build()} when using specific
 * vertex label grouping.
 */
@Test
public void testVertexLabelSpecificGroup() {
    String testGroupLabel = "testGroup";
    ImmutableList<String> testGroupingKeys = ImmutableList.of("a", "b");
    UnaryBaseGraphToBaseGraphOperator<LogicalGraph> grouping = new Grouping.GroupingBuilder().setStrategy(GroupingStrategy.GROUP_REDUCE).addVertexLabelGroup(testGroupLabel, testGroupingKeys).build();
    assertTrue(grouping instanceof Grouping);
    List<LabelGroup> vertexLabelGroups = ((Grouping<EPGMGraphHead, EPGMVertex, EPGMEdge, LogicalGraph, GraphCollection>) grouping).getVertexLabelGroups();
    // first element of vertexLabelGroups is always the defaultVertexLabelGroup, so the label
    // specific group should be at index 1.
    LabelGroup group = vertexLabelGroups.get(1);
    assertEquals(group.getGroupLabel(), testGroupLabel);
    assertEquals(testGroupingKeys, group.getPropertyKeys());
}