@Override
public void write(LogicalGraph logicalGraph, boolean overwrite) throws IOException {
    FileSystem.WriteMode writeMode = overwrite ? FileSystem.WriteMode.OVERWRITE : FileSystem.WriteMode.NO_OVERWRITE;
    DataSet<Tuple3<String, String, String>> metaData;
    if (!reuseMetadata()) {
        metaData = createMetaData(logicalGraph);
    } else {
        metaData = MetaData.fromFile(metaDataPath, getConfig());
    }
    DataSet<CSVVertex> csvVertices = logicalGraph.getVertices().map(new VertexToCSVVertex()).withBroadcastSet(metaData, BC_METADATA);
    DataSet<CSVEdge> csvEdges = logicalGraph.getEdges().map(new EdgeToCSVEdge()).withBroadcastSet(metaData, BC_METADATA);
    // Write metadata only if the path is not the same or reuseMetadata is false.
    if (!getMetaDataPath().equals(metaDataPath) || !reuseMetadata()) {
        metaData.writeAsCsv(getMetaDataPath(), CSVConstants.ROW_DELIMITER, CSVConstants.TOKEN_DELIMITER, writeMode).setParallelism(1);
    }
    csvVertices.writeAsCsv(getVertexCSVPath(), CSVConstants.ROW_DELIMITER, CSVConstants.TOKEN_DELIMITER, writeMode);
    csvEdges.writeAsCsv(getEdgeCSVPath(), CSVConstants.ROW_DELIMITER, CSVConstants.TOKEN_DELIMITER, writeMode);
}