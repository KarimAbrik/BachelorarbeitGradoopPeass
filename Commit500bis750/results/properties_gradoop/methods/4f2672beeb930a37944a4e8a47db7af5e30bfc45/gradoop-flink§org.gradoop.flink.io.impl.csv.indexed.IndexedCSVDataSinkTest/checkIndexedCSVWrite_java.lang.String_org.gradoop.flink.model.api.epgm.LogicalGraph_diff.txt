/**
 * Test writing and reading the given graph to and from IndexedCSV
 *
 * @param tmpPath path to write csv
 * @param input logical graph
 * @throws Exception on failure
 */
private void checkIndexedCSVWrite(String tmpPath, LogicalGraph input) throws Exception {
    DataSink csvDataSink = new IndexedCSVDataSink(tmpPath, getConfig());
    csvDataSink.write(input, true);
    getExecutionEnvironment().execute();
    DataSource csvDataSource = new IndexedCSVDataSource(tmpPath, getConfig());
    LogicalGraph output = csvDataSource.getLogicalGraph();
    collectAndAssertTrue(input.equalsByElementData(output));
}