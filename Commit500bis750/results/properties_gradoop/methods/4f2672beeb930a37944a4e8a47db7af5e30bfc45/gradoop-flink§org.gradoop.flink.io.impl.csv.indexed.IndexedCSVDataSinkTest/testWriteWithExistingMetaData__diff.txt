@Test
public void testWriteWithExistingMetaData() throws Exception {
    String tmpPath = temporaryFolder.getRoot().getPath();
    String csvPath = VertexLabeledEdgeListDataSourceTest.class.getResource("/data/csv/input_indexed").getFile();
    String gdlPath = IndexedCSVDataSourceTest.class.getResource("/data/csv/expected/expected.gdl").getFile();
    LogicalGraph input = getLoaderFromFile(gdlPath).getLogicalGraphByVariable("expected");
    DataSink csvDataSink = new IndexedCSVDataSink(tmpPath, csvPath + "/metadata.csv", getConfig());
    csvDataSink.write(input, true);
    getExecutionEnvironment().execute();
    DataSource csvDataSource = new IndexedCSVDataSource(tmpPath, getConfig());
    LogicalGraph output = csvDataSource.getLogicalGraph();
    collectAndAssertTrue(input.equalsByElementData(output));
}