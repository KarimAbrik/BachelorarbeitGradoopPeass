@Test
public void testSingleGraphVertexAndEdgeMin() throws Exception {
    LogicalGraph graph = getLoaderFromString("org:Ga[" + "(:Va{vp : 0.5f})-[:ea{ep : 2}]->(:Vb{vp : 3.1f})" + "(:Vc{vp : 0.33f})-[:eb]->(:Vd{vp : 0.0f})" + "]").getLogicalGraphByVariable("org");
    MinVertexProperty minVertexProperty = new MinVertexProperty(VERTEX_PROPERTY);
    MinEdgeProperty minEdgeProperty = new MinEdgeProperty(EDGE_PROPERTY);
    graph = graph.aggregate(minVertexProperty).aggregate(minEdgeProperty);
    EPGMGraphHead graphHead = graph.getGraphHead().collect().get(0);
    assertTrue("edge minimum not set", graphHead.hasProperty(minEdgeProperty.getAggregatePropertyKey()));
    assertTrue("vertex minimum not set", graphHead.hasProperty(minVertexProperty.getAggregatePropertyKey()));
    assertEquals(2, graphHead.getPropertyValue(minEdgeProperty.getAggregatePropertyKey()).getInt());
    assertEquals(0.0f, graphHead.getPropertyValue(minVertexProperty.getAggregatePropertyKey()).getFloat(), 0.00001f);
}