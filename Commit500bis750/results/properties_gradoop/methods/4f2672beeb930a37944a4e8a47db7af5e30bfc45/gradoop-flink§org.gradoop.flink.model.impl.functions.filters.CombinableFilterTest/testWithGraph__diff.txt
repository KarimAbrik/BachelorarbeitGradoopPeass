@Test
public void testWithGraph() throws Exception {
    FlinkAsciiGraphLoader loader = getSocialNetworkLoader();
    loader.appendToDatabaseFromString("expected[" + // gender = 'f' and city = 'leipzig'
    "(alice)" + // label = 'Tag'
    "(databases)(graphs)(hadoop)" + "]");
    LogicalGraph databaseGraph = loader.getDatabase().getDatabaseGraph();
    // Filter vertices where
    // (gender = 'f' AND city = 'Leipzig') OR NOT(label = 'Person' OR label = 'Forum')
    FilterFunction<Vertex> vertexFilterFunction = new ByProperty<Vertex>("gender", PropertyValue.create("f")).and(new ByProperty<>("city", PropertyValue.create("Leipzig"))).or(new ByLabel<>("Person").or(new ByLabel<>("Forum")).negate());
    // Filter edges where
    // label <> 'hasInterest'
    LogicalGraph subgraph = databaseGraph.subgraph(vertexFilterFunction, new ByLabel<Edge>("hasInterest").negate(), Subgraph.Strategy.BOTH);
    collectAndAssertTrue(subgraph.equalsByElementIds(loader.getLogicalGraphByVariable("expected")));
}