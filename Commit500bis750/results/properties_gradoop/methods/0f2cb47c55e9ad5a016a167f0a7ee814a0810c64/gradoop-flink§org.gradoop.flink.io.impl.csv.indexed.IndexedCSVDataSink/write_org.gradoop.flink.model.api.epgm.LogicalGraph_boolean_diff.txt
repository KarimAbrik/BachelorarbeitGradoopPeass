@Override
public void write(LogicalGraph logicalGraph, boolean overwrite) throws IOException {
    WriteMode writeMode = overwrite ? WriteMode.OVERWRITE : WriteMode.NO_OVERWRITE;
    DataSet<Tuple3<String, String, String>> metaData;
    if (!reuseMetadata()) {
        metaData = createMetaData(logicalGraph);
    } else {
        metaData = MetaData.fromFile(metaDataPath, getConfig());
    }
    DataSet<CSVVertex> csvVertices = logicalGraph.getVertices().map(new VertexToCSVVertex()).withBroadcastSet(metaData, BC_METADATA);
    DataSet<CSVEdge> csvEdges = logicalGraph.getEdges().map(new EdgeToCSVEdge()).withBroadcastSet(metaData, BC_METADATA);
    if (!getMetaDataPath().equals(metaDataPath) || !reuseMetadata()) {
        metaData.writeAsCsv(getMetaDataPath(), CSVConstants.ROW_DELIMITER, CSVConstants.TOKEN_DELIMITER, writeMode).setParallelism(1);
    }
    csvVertices.output(internalWriteAsIndexedCsv(csvVertices, new Path(getVertexPath()), CSVConstants.ROW_DELIMITER, CSVConstants.TOKEN_DELIMITER, writeMode));
    csvEdges.output(internalWriteAsIndexedCsv(csvEdges, new Path(getEdgePath()), CSVConstants.ROW_DELIMITER, CSVConstants.TOKEN_DELIMITER, writeMode));
}