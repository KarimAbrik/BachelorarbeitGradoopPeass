/**
 * Test the content of the metadata.csv file
 *
 * @throws Exception on failure
 */
@Test
public void testWriteMetadataCsv() throws Exception {
    String tmpPath = temporaryFolder.getRoot().getPath();
    LogicalGraph logicalGraph = getExtendedLogicalGraph();
    DataSink csvDataSink = new CSVDataSink(tmpPath, getConfig());
    csvDataSink.write(logicalGraph, true);
    getExecutionEnvironment().execute();
    String metadataFile = tmpPath + "/metadata.csv";
    String line;
    BufferedReader br = new BufferedReader(new FileReader(metadataFile));
    while ((line = br.readLine()) != null) {
        checkMetadataCsvLine(line);
    }
}