@Test                                                                                                  @Test                                                                                               
public void testAssignment() throws Exception {                                                        public void testAssignment() throws Exception {                                                     
LogicalGraph&lt;DefaultVertexData, DefaultEdgeData, DefaultGraphData&gt; databaseCommunity = getGrap   LogicalGraph&lt;DefaultVertexData, DefaultEdgeData, DefaultGraphData&gt; databaseCommunity = getGrap
LogicalGraph&lt;DefaultVertexData, DefaultEdgeData, DefaultGraphData&gt; graphCommunity = getGraphSt   LogicalGraph&lt;DefaultVertexData, DefaultEdgeData, DefaultGraphData&gt; graphCommunity = getGraphSt
LogicalGraph&lt;DefaultVertexData, DefaultEdgeData, DefaultGraphData&gt; newGraph = graphCommunity.c   LogicalGraph&lt;DefaultVertexData, DefaultEdgeData, DefaultGraphData&gt; newGraph = graphCommunity.c
Collection&lt;DefaultVertexData&gt; vertexData = newGraph.getVertexData().collect();                 | // use collections as data sink                                                                     
Collection&lt;DefaultEdgeData&gt; edgeData = newGraph.getEdgeData().collect();                       | Collection&lt;DefaultVertexData&gt; vertexData = Lists.newArrayList();                              
                                                                                                     | Collection&lt;DefaultEdgeData&gt; edgeData = Lists.newArrayList();                                  
                                                                                                     | newGraph.getVertexData().output(new LocalCollectionOutputFormat&lt;&gt;(vertexData));               
                                                                                                     | newGraph.getEdgeData().output(new LocalCollectionOutputFormat&lt;&gt;(edgeData));                   
                                                                                                     | getExecutionEnvironment().execute();                                                                
for (VertexData v : vertexData) {                                                                      for (VertexData v : vertexData) {                                                                   
Set&lt;Long&gt; gIDs = v.getGraphs();                                                                  Set&lt;Long&gt; gIDs = v.getGraphs();                                                               
if (v.equals(VERTEX_PERSON_ALICE)) {                                                                   if (v.equals(VERTEX_PERSON_ALICE)) {                                                                
assertEquals("wrong number of graphs", 3, gIDs.size());                                                assertEquals("wrong number of graphs", 3, gIDs.size());                                             
} else if (v.equals(VERTEX_PERSON_BOB)) {                                                              } else if (v.equals(VERTEX_PERSON_BOB)) {                                                           
assertEquals("wrong number of graphs", 3, gIDs.size());                                                assertEquals("wrong number of graphs", 3, gIDs.size());                                             
} else if (v.equals(VERTEX_PERSON_EVE)) {                                                              } else if (v.equals(VERTEX_PERSON_EVE)) {                                                           
assertEquals("wrong number of graphs", 2, gIDs.size());                                                assertEquals("wrong number of graphs", 2, gIDs.size());                                             
} else if (v.equals(VERTEX_PERSON_CAROL)) {                                                            } else if (v.equals(VERTEX_PERSON_CAROL)) {                                                         
assertEquals("wrong number of graphs", 4, gIDs.size());                                                assertEquals("wrong number of graphs", 4, gIDs.size());                                             
} else if (v.equals(VERTEX_PERSON_DAVE)) {                                                             } else if (v.equals(VERTEX_PERSON_DAVE)) {                                                          
assertEquals("wrong number of graphs", 4, gIDs.size());                                                assertEquals("wrong number of graphs", 4, gIDs.size());                                             
} else if (v.equals(VERTEX_PERSON_FRANK)) {                                                            } else if (v.equals(VERTEX_PERSON_FRANK)) {                                                         
assertEquals("wrong number of graphs", 2, gIDs.size());                                                assertEquals("wrong number of graphs", 2, gIDs.size());                                             
}                                                                                                      }                                                                                                   
}                                                                                                      }                                                                                                   
for (EdgeData e : edgeData) {                                                                          for (EdgeData e : edgeData) {                                                                       
Set&lt;Long&gt; gIDs = e.getGraphs();                                                                  Set&lt;Long&gt; gIDs = e.getGraphs();                                                               
if (e.equals(EDGE_0_KNOWS)) {                                                                          if (e.equals(EDGE_0_KNOWS)) {                                                                       
assertEquals("wrong number of graphs", 3, gIDs.size());                                                assertEquals("wrong number of graphs", 3, gIDs.size());                                             
} else if (e.equals(EDGE_1_KNOWS)) {                                                                   } else if (e.equals(EDGE_1_KNOWS)) {                                                                
assertEquals("wrong number of graphs", 3, gIDs.size());                                                assertEquals("wrong number of graphs", 3, gIDs.size());                                             
} else if (e.equals(EDGE_6_KNOWS)) {                                                                   } else if (e.equals(EDGE_6_KNOWS)) {                                                                
assertEquals("wrong number of graphs", 2, gIDs.size());                                                assertEquals("wrong number of graphs", 2, gIDs.size());                                             
} else if (e.equals(EDGE_21_KNOWS)) {                                                                  } else if (e.equals(EDGE_21_KNOWS)) {                                                               
assertEquals("wrong number of graphs", 2, gIDs.size());                                                assertEquals("wrong number of graphs", 2, gIDs.size());                                             
} else if (e.equals(EDGE_4_KNOWS)) {                                                                   } else if (e.equals(EDGE_4_KNOWS)) {                                                                
assertEquals("wrong number of graphs", 4, gIDs.size());                                                assertEquals("wrong number of graphs", 4, gIDs.size());                                             
} else if (e.equals(EDGE_5_KNOWS)) {                                                                   } else if (e.equals(EDGE_5_KNOWS)) {                                                                
assertEquals("wrong number of graphs", 3, gIDs.size());                                                assertEquals("wrong number of graphs", 3, gIDs.size());                                             
} else if (e.equals(EDGE_22_KNOWS)) {                                                                  } else if (e.equals(EDGE_22_KNOWS)) {                                                               
assertEquals("wrong number of graphs", 2, gIDs.size());                                                assertEquals("wrong number of graphs", 2, gIDs.size());                                             
} else if (e.equals(EDGE_23_KNOWS)) {                                                                  } else if (e.equals(EDGE_23_KNOWS)) {                                                               
assertEquals("wrong number of graphs", 2, gIDs.size());                                                assertEquals("wrong number of graphs", 2, gIDs.size());                                             
}                                                                                                      }                                                                                                   
}                                                                                                      }                                                                                                   
}                                                                                                      }                                                                                                   
